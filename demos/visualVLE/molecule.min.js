class Molecule{constructor(i){let t={a:Acolor,b:Bcolor};this.component=i.component||"a",this.color=i.color||t[`${this.component}`],this.diameter=i.diameter||22,this.temperature=i.temperature||290,this.direction=Math.random()*Math.PI*2;let s=Math.random();this.state=s>fracLiq?"vapor":"liquid",this.speed=(this.temperature-273)/3,this.velocity=[Math.cos(this.direction)*this.speed,Math.sin(this.direction)*this.speed],this.position=[Math.trunc(Math.random()*dims),0],this.position[1]="vapor"==this.state?Math.trunc(Math.random()*liquidLine):liquidLine+Math.trunc(Math.random()*(yDims-liquidLine)),this.noiseScaleXY=8,this.noiseScaleTheta=.8,this.noiseSeed=Math.trunc(1e3*Math.random()),this.noiseX=0,this.noiseY=0,this.noiseTheta=0,this.onoff=!0,this.div=document.createElement("div"),this.div.style.backgroundColor=this.color,this.div.classList.add("molecule"),this.div.style.top=`${this.position[1]}px`,this.div.style.left=`${this.position[0]}px`,this.div.style.height=`${this.diameter}px`,this.div.style.width=`${this.diameter}px`,this.div.style.borderRadius=`${this.diameter/2}px`,this.div.style.zIndex=Math.random()>.5?"2":"3",this.div.style.opacity="1",document.getElementById("molecules").appendChild(this.div),"liquid"==this.state?(molsLiquid[0]++,"a"==this.component?molsLiquid[1]++:molsLiquid[2]++):(molsVapor[0]++,"a"==this.component?molsVapor[1]++:molsVapor[2]++),xA=molsLiquid[1]/molsLiquid[0],yA=molsVapor[1]/molsVapor[0],xB=1-xA,yB=1-yA}Draw(){this.Move(),this.div.style.top=`${this.position[1]}px`,this.div.style.left=`${this.position[0]}px`}Move(i){if(this.onoff=!this.onoff,this.onoff&&(this.noiseX=this.noiseScaleXY*Math.random()-this.noiseScaleXY/2,this.noiseY=this.noiseScaleXY*Math.random()-this.noiseScaleXY/2),this.position[0]<=0?this.velocity[0]=Math.abs(this.velocity[0]):this.position[0]>=dims-this.diameter-2&&(this.velocity[0]=-1*Math.abs(this.velocity[0])),this.position[1]<=0?this.velocity[1]=Math.abs(this.velocity[1]):this.position[1]>=yDims-this.diameter-2&&(this.velocity[1]=-1*Math.abs(this.velocity[1])),"vapor"==this.state&&this.position[1]>=liquidLine-this.diameter){const i=this.Condense();this.velocity[1]=i?Math.abs(this.velocity[1]):-1*Math.abs(this.velocity[1]),this.noiseY=i?Math.abs(this.noiseY):-1*Math.abs(this.noiseY)}else if("liquid"==this.state&&this.position[1]<=liquidLine){const i=this.Evaporate();this.velocity[1]=i?-1*Math.abs(this.velocity[1]):Math.abs(this.velocity[1]),this.noiseY=i?-1*Math.abs(this.noiseY):2*Math.abs(this.noiseY)}const t=[this.velocity[0]+this.noiseX,this.velocity[1]+this.noiseY];this.position[0]=Math.max(0,Math.min(dims-this.diameter,this.position[0]+t[0])),this.position[1]=Math.max(0,Math.min(yDims-this.diameter,this.position[1]+t[1]))}Condense(){return molsLiquid[0]++,molsVapor[0]--,"a"==this.component?(molsLiquid[1]++,molsVapor[1]--):(molsLiquid[2]++,molsVapor[2]--),xA=molsLiquid[1]/molsLiquid[0],xB=1-xA,this.state="liquid",this.position[1]+=this.diameter,!0}Evaporate(){return("a"==this.component&&yA/xA/(yB/xB)<=Alpha||"b"==this.component&&yA/xA/(yB/xB)>=Alpha)&&molsLiquid[0]/mols>=fracLiq&&(molsVapor[0]++,molsLiquid[0]--,"a"==this.component?(molsVapor[1]++,molsLiquid[1]--):(molsVapor[2]++,molsLiquid[2]--),yA=molsVapor[1]/molsVapor[0],yB=1-yA,this.state="vapor",this.position[1]-=this.diameter,!0)}ChangeComponent(i){this.component!=i&&("vapor"==this.state?"a"==this.component?(molsVapor[1]--,molsVapor[2]++):(molsVapor[1]++,molsVapor[2]--):"a"==this.component?(molsLiquid[1]--,molsLiquid[2]++):(molsLiquid[1]++,molsLiquid[2]--),xA=molsLiquid[1]/molsLiquid[0],xB=1-xA,yA=molsVapor[1]/molsVapor[0],yB=1-yA,this.component=i,this.color="a"==this.component?Acolor:Bcolor,this.div.style.backgroundColor=this.color,this.div.style.zIndex=Math.random()>.5?"2":"3")}}