class Molecule{constructor(i){let t={a:"rgba(100, 180, 0, 0.75)",b:"rgba(50, 0, 150, 0.75)"};this.component=i.component||"a",this.color=i.color||t[`${this.component}`],this.diameter=i.diameter||10,this.temperature=i.temperature||290,this.direction=Math.random()*Math.PI*2;let s=Math.random();this.state=s>fracLiq?"vapor":"liquid",this.speed="vapor"==this.state?(this.temperature-273)/3:(this.temperature-273)/10,this.velocity=[Math.cos(this.direction)*this.speed,Math.sin(this.direction)*this.speed],this.position=[Math.trunc(Math.random()*dims),0],this.position[1]="vapor"==this.state?Math.trunc(Math.random()*liquidLine):liquidLine+Math.trunc(Math.random()*(dims-liquidLine)),this.noiseScaleXY=5,this.noiseScaleTheta=.2,this.noiseSeedX=Math.trunc(1e3*Math.random()),this.noiseSeedY=Math.trunc(1e3*Math.random()),this.noiseSeedTheta=Math.trunc(1e3*Math.random())/1e3,this.div=document.createElement("div"),this.div.style.backgroundColor=this.color,this.div.classList.add("molecule"),this.div.style.top=`${this.position[1]}px`,this.div.style.left=`${this.position[0]}px`,document.body.appendChild(this.div),"liquid"==this.state?(molsLiquid[0]++,"a"==this.component?molsLiquid[1]++:molsLiquid[2]++):(molsVapor[0]++,"a"==this.component?molsVapor[1]++:molsVapor[2]++),xA=molsLiquid[1]/molsLiquid[0],yA=molsVapor[1]/molsVapor[0],xB=1-xA,yB=1-yA}Draw(){this.Move(),this.div.style.top=`${this.position[1]}px`,this.div.style.left=`${this.position[0]}px`}Move(){this.noiseSeedX+=.25,this.noiseSeedY+=.25,this.noiseSeedTheta+=.05,this.direction=atan2(this.velocity[1],this.velocity[0]);let i=this.noiseScaleXY*noise(this.noiseSeedX)-this.noiseScaleXY/2,t=this.noiseScaleXY*noise(this.noiseSeedY)-this.noiseScaleXY/2,s=Math.random()*this.noiseScaleTheta-this.noiseScaleTheta/2;if(this.direction+=s,this.velocity=[Math.cos(this.direction)*this.speed,Math.sin(this.direction)*this.speed],this.position[0]<=0&&(this.velocity[0]=Math.abs(this.velocity[0])),this.position[0]>=dims-this.diameter&&(this.velocity[0]=-1*Math.abs(this.velocity[0])),this.position[1]<=0&&(this.velocity[1]=Math.abs(this.velocity[1])),this.position[1]>=dims-this.diameter&&(this.velocity[1]=-1*Math.abs(this.velocity[1])),"vapor"==this.state&&this.position[1]>=liquidLine-this.diameter){let i=this.Condense();this.velocity[1]=i?Math.abs(this.velocity[1]):-1*Math.abs(this.velocity[1]),t=i?Math.abs(t):-1*Math.abs(t)}if("liquid"==this.state&&this.position[1]<=liquidLine){let i=this.Evaporate();this.velocity[1]=i?-1*Math.abs(this.velocity[1]):Math.abs(this.velocity[1]),t=i?-1*Math.abs(t):2*Math.abs(t)}let o=[this.velocity[0]+i,this.velocity[1]+t];this.position[0]=Math.max(0,Math.min(dims-this.diameter,this.position[0]+o[0])),this.position[1]=Math.max(0,Math.min(dims-this.diameter,this.position[1]+o[1]))}Condense(){return("a"==this.component&&yA/xA/(yB/xB)>=Alpha||"b"==this.component&&yA/xA/(yB/xB)<=Alpha)&&Math.random()<condFraction&&molsVapor[0]/mols>=1-fracLiq&&(molsLiquid[0]++,molsVapor[0]--,"a"==this.component?(molsLiquid[1]++,molsVapor[1]--):(molsLiquid[2]++,molsVapor[2]--),xA=molsLiquid[1]/molsLiquid[0],xB=1-xA,this.state="liquid",this.position[1]+=this.diameter/2,this.speed/=3,!0)}Evaporate(){return("a"==this.component&&yA/xA/(yB/xB)<=Alpha||"b"==this.component&&yA/xA/(yB/xB)>=Alpha)&&Math.random()<evapFraction&&molsLiquid[0]/mols>=fracLiq&&(molsVapor[0]++,molsLiquid[0]--,"a"==this.component?(molsVapor[1]++,molsLiquid[1]--):(molsVapor[2]++,molsLiquid[2]--),yA=molsVapor[1]/molsVapor[0],yB=1-yA,this.state="vapor",this.position[1]-=this.diameter,this.speed*=2.5+Math.random(),!0)}}