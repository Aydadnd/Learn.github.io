function startAnimating(e){fpsInterval=1e3/e,then=Date.now(),startTime=then,animate()}function animate(){if(!stop&&(requestAnimationFrame(animate),now=Date.now(),elapsed=now-then,elapsed>fpsInterval)){then=now-elapsed%fpsInterval,drawBarChart();for(let e=onoff?0:1;e<mol.length;e+=2)mol[e].Draw();for(onoff=!onoff;mols<mol.length;){let e=mol[mol.length-1];"a"==e.component?"vapor"==e.state?(molsVapor[0]--,molsVapor[1]--):(molsLiquid[0]--,molsLiquid[1]--):"vapor"==e.state?(molsVapor[0]--,molsVapor[2]--):(molsLiquid[0]--,molsLiquid[2]--),mol.pop(),e.div.remove()}for(;mols>mol.length;)mol.length%2==0?mol.push(new Molecule({component:"a"})):mol.push(new Molecule({component:"b"}))}}function updateGlobals(){Alpha=Math.pow(10,volatilitySlider.value),alphaLabel.innerHTML=`relative volatility (&#945): ${Number.parseFloat(Alpha).toFixed(2)}`,mols=parseInt(molNumberSlider.value),molNumberLabel.innerText=`number of particles: ${mols}`,xLabel.innerHTML=`x<sub>A</sub>: ${xAtarget}`,xAtarget=parseFloat(xSlider.value),yAtarget=Alpha*xAtarget/(1-xAtarget+Alpha*xAtarget),zA=xAtarget*fracLiq+(1-fracLiq)*yAtarget;for(let e=0;e<mol.length;e++)e<=mols*zA?mol[e].ChangeComponent("a"):mol[e].ChangeComponent("b")}function addBarChart(){bc=document.createElement("div"),bc.id="barchart",document.body.appendChild(bc),bc=document.getElementById("barchart"),bc.style.display="block",bc.style.position="absolute",bc.style.background="rgba(255, 255, 255, 1)",leftBarBottom=document.createElement("div"),leftBarBottom.id="lbb",leftBarTop=document.createElement("div"),leftBarTop.id="lbt",rightBarBottom=document.createElement("div"),rightBarBottom.id="rbb",rightBarTop=document.createElement("div"),rightBarTop.id="rbt",leftBarLabel=document.createElement("div"),rightBarLabel=document.createElement("div"),leftBarLabel.id="lbl",rightBarLabel.id="rbl",bc.appendChild(leftBarBottom),bc.appendChild(leftBarTop),bc.appendChild(rightBarBottom),bc.appendChild(rightBarTop),bc.appendChild(leftBarLabel),bc.appendChild(rightBarLabel),leftBarBottom=document.getElementById("lbb"),leftBarTop=document.getElementById("lbt"),rightBarBottom=document.getElementById("rbb"),rightBarTop=document.getElementById("rbt"),leftBarLabel=document.getElementById("lbl"),rightBarLabel=document.getElementById("rbl"),leftBarBottom.style.background=`${Acolor}`,rightBarBottom.style.background=`${Acolor}`,leftBarTop.style.background=`${Bcolor}`,rightBarTop.style.background=`${Bcolor}`,leftBarBottom.style.position="absolute",leftBarTop.style.position="absolute",rightBarBottom.style.position="absolute",rightBarTop.style.position="absolute",leftBarLabel.style.position="absolute",rightBarLabel.style.position="absolute",leftBarLabel.innerText="liquid",rightBarLabel.innerText="vapor",leftBarLabel.style.textAlign="center",rightBarLabel.style.textAlign="center";let e=1;leftBarTop.style.transition=`height ${e}s`,rightBarTop.style.transition=`height ${e}s`}function drawBarChart(){checked?(leftBarTop.style.height=`${barHeight*(1-xA)}px`,rightBarTop.style.height=`${barHeight*(1-yA)}px`):(leftBarTop.style.height=`${barHeight*(1-xAtarget)}px`,rightBarTop.style.height=`${barHeight*(1-yAtarget)}px`)}function resize(){let e=window.innerWidth,t=window.innerHeight;dims=Math.min(400,Math.min(t-100,e/2-20)),liquidLine=dims-liquidLevel*dims,evapFraction=(1-fracLiq)*(dims-liquidLine)/dims/((1-fracLiq)*(dims-liquidLine)/dims+fracLiq*liquidLine/dims),condFraction=fracLiq*liquidLine/dims/((1-fracLiq)*(dims-liquidLine)/dims+fracLiq*liquidLine/dims);let l=document.getElementById("canvas0"),o=document.getElementById("subCanvas");l.style.width=`${dims}px`,o.style.width=`${dims}px`,l.style.height=`${dims}px`,o.style.height=`${dims*liquidLevel}px`,o.style.top=`${dims*(1-liquidLevel)}px`,bc.style.left="0px",bc.style.top=`${dims+20}px`,bc.style.width=`${dims}px`,bc.style.height=`${dims}px`;let i=10;leftBarLabel.style.bottom="0px",rightBarLabel.style.bottom="0px",barHeight=dims-2*i-Math.max(getCoords("lbl").height,getCoords("rbl").height),leftBarBottom.style.width=`${dims/2-2*i}px`,rightBarBottom.style.width=`${dims/2-2*i}px`,leftBarTop.style.width=`${dims/2-2*i}px`,rightBarTop.style.width=`${dims/2-2*i}px`,leftBarLabel.style.width=`${getCoords("lbb").width}px`,rightBarLabel.style.width=`${getCoords("rbb").width}px`,leftBarBottom.style.height=`${barHeight}px`,rightBarBottom.style.height=`${barHeight}px`,leftBarBottom.style.top=`${(dims-barHeight)/3}px`,leftBarTop.style.top=`${(dims-barHeight)/3}px`,rightBarBottom.style.top=`${(dims-barHeight)/3}px`,rightBarTop.style.top=`${(dims-barHeight)/3}px`,leftBarBottom.style.left=`${i}px`,leftBarTop.style.left=`${i}px`,rightBarBottom.style.left=`${dims/2+i}px`,rightBarTop.style.left=`${dims/2+i}px`,leftBarLabel.style.left=`${getCoords("lbb").left}px`,rightBarLabel.style.left=`${getCoords("rbb").left}px`,"object"==typeof molNumberSlider&&(molNumberLabel.position(getCoords("canvas0").right,getCoords("canvas0").top+10),molNumberSlider.position(getCoords("canvas0").right,getCoords("mnl").bottom+10),alphaLabel.position(getCoords("canvas0").right,getCoords("mns").top+30),volatilitySlider.position(getCoords("canvas0").right,getCoords("al").bottom+10),xSlider.position(getCoords("canvas0").right,getCoords("xl").bottom+10),xLabel.position(getCoords("canvas0").right,getCoords("vs").bottom+10))}function getCoords(e){let t=document.getElementById(e),l=t.getBoundingClientRect();return{top:l.top+pageYOffset,left:l.left+pageXOffset,bottom:l.top+pageYOffset+l.height,right:l.left+pageXOffset+l.width,height:l.height,width:l.width}}function addSliders(){molNumberLabel=document.createElement("div"),molNumberLabel.id="mnl",mainDiv.appendChild(molNumberLabel),molNumberLabel=document.getElementById("mnl"),molNumberLabel.innerHTML=`number of particles: ${mols}`,molNumberLabel.position=((e,t)=>{molNumberLabel.style.left=`${e}px`,molNumberLabel.style.top=`${t}px`}),molNumberSlider=document.createElement("input"),molNumberSlider.id="mns",mainDiv.appendChild(molNumberSlider),molNumberSlider=document.getElementById("mns"),molNumberSlider.type="range",molNumberSlider.min=10,molNumberSlider.max=500,molNumberSlider.value=80,molNumberSlider.step=1,molNumberSlider.style.width="100px",molNumberSlider.position=((e,t)=>{molNumberSlider.style.left=`${e}px`,molNumberSlider.style.top=`${t}px`}),alphaLabel=document.createElement("div"),alphaLabel.id="al",mainDiv.appendChild(alphaLabel),alphaLabel=document.getElementById("al"),alphaLabel.innerHTML=`relative volatility (&#945): ${Alpha}`,alphaLabel.position=((e,t)=>{alphaLabel.style.left=`${e}px`,alphaLabel.style.top=`${t}px`}),volatilitySlider=document.createElement("input"),volatilitySlider.id="vs",mainDiv.appendChild(volatilitySlider),volatilitySlider=document.getElementById("vs"),volatilitySlider.type="range",volatilitySlider.min=-1,volatilitySlider.max=1,volatilitySlider.value=0,volatilitySlider.step=.1,volatilitySlider.style.width="100px",volatilitySlider.position=((e,t)=>{volatilitySlider.style.left=`${e}px`,volatilitySlider.style.top=`${t}px`}),xLabel=document.createElement("div"),xLabel.id="xl",mainDiv.appendChild(xLabel),xLabel=document.getElementById("xl"),xLabel.innerHTML=`x<sub>A</sub>: ${xAtarget}`,xLabel.position=((e,t)=>{xLabel.style.left=`${e}px`,xLabel.style.top=`${t}px`}),xSlider=document.createElement("input"),xSlider.id="xs",mainDiv.appendChild(xSlider),xSlider=document.getElementById("xs"),xSlider.type="range",xSlider.min=.03,xSlider.max=.97,xSlider.step=.01,xSlider.value=.5,xSlider.style.width="100px",xSlider.position=((e,t)=>{xSlider.style.left=`${e}px`,xSlider.style.top=`${t}px`}),molNumberLabel.style.position="absolute",molNumberSlider.style.position="absolute",alphaLabel.style.position="absolute",volatilitySlider.style.position="absolute",xLabel.style.position="absolute",xSlider.style.position="absolute",document.getElementById("mns").oninput=updateGlobals,document.getElementById("vs").oninput=updateGlobals,document.getElementById("xs").oninput=updateGlobals,molNumberLabel.position(getCoords("canvas0").right,getCoords("canvas0").top+10),molNumberSlider.position(getCoords("canvas0").right,getCoords("mnl").bottom+10),alphaLabel.position(getCoords("canvas0").right,getCoords("mns").bottom+10),volatilitySlider.position(getCoords("canvas0").right,getCoords("al").bottom+10),xLabel.position(getCoords("canvas0").right,getCoords("vs").bottom+10),xSlider.position(getCoords("canvas0").right,getCoords("xl").bottom+10)}let dims,cnv,bc,barHeight,xLabel,xSlider,leftBarLabel,rightBarLabel,leftBarTop,leftBarBottom,rightBarTop,rightBarBottom,mainDiv,liquidColor,liquidLine,alphaLabel,molNumberSlider,molNumberLabel,evapFraction,condFraction,mol=[],liquidLevel=.15;var mols=80,Alpha=1,fracLiq=.85,molsVapor=[0,0,0],molsLiquid=[0,0,0],xA=.5,xB=.5,yA=.5,yB=.5,zA=.5,xAtarget=.5,yAtarget=.5;let Acolor="rgb(80, 0, 180)",Bcolor="rgb(130, 180, 0)";var fps,fpsInterval,startTime,now,then,elapsed,checked=!1,timeNow=null,stop=!1,frameCount=0,onoff=!0;window.onload=(e=>{addBarChart(),resize(),mainDiv=document.getElementById("main");for(let e=0;e<mols;e++)e%2==0?mol.push(new Molecule({component:"a"})):mol.push(new Molecule({component:"b"}));addSliders(),startAnimating(120)});