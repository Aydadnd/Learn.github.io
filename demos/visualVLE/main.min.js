function startAnimating(t){fpsInterval=1e3/t,then=Date.now(),startTime=then,animate()}function animate(){if(!stop&&(requestAnimationFrame(animate),now=Date.now(),elapsed=now-then,elapsed>fpsInterval)){then=now-elapsed%fpsInterval,drawBarChart();for(let t=onoff?0:1;t<mol.length;t+=2)mol[t].Draw();for(onoff=!onoff;mols<mol.length;){let t=mol[mol.length-1];"a"==t.component?"vapor"==t.state?(molsVapor[0]--,molsVapor[1]--):(molsLiquid[0]--,molsLiquid[1]--):"vapor"==t.state?(molsVapor[0]--,molsVapor[2]--):(molsLiquid[0]--,molsLiquid[2]--),mol.pop(),t.div.remove()}for(;mols>mol.length;)mol.length%2==0?mol.push(new Molecule({component:"a"})):mol.push(new Molecule({component:"b"}))}}function updateGlobals(){Alpha=Math.pow(10,volatilitySlider.value/100),alphaLabel.innerHTML=`relative volatility (&#945<sub>blue/green</sub>): ${Number.parseFloat(Alpha).toFixed(2)}`,mols=parseInt(molNumberSlider.value),molNumberLabel.innerText=`number of particles: ${mols}`,xLabel.innerHTML=`<i>x</i><sub>blue</sub>: ${Number.parseFloat(xAtarget).toFixed(2)}`,xAtarget=parseFloat(xSlider.value),yAtarget=Alpha*xAtarget/(1-xAtarget+Alpha*xAtarget),zA=xAtarget*fracLiq+(1-fracLiq)*yAtarget;for(let t=0;t<mol.length;t++)t<=mols*zA?mol[t].ChangeComponent("a"):mol[t].ChangeComponent("b");const t=document.getElementById("liqCanvas"),e=document.getElementById("vapCanvas"),l=255/180,o=255/180;t.style.background=`rgba(${l*(130-50*xAtarget)}, ${l*(180-180*xAtarget)}, ${l*(180*xAtarget)}, 0.6)`,e.style.background=`rgba(${o*(130-50*yAtarget)}, ${o*(180-180*yAtarget)}, ${o*(180*yAtarget)}, 0.3)`}function addButtons(){nav=document.getElementById("nav"),buttonHeight=70,about={content:""},directions={content:""},details={content:""},about.modal=new Modal({modalid:"modal-about",modalclass:"modal moveUp",headerstyle:"",header:"About",contentstyle:"",content:about.content,showing:!1}),directions.modal=new Modal({modalid:"modal-directions",modalclass:"modal moveUp",headerstyle:"",header:"Directions",contentstyle:"",content:directions.content,showing:!1}),details.modal=new Modal({modalid:"modal-details",modalclass:"modal moveUp",headerstyle:"",header:"Details",contentstyle:"",content:details.content,showing:!1}),about.button=document.getElementById("about").addEventListener("click",()=>about.modal.show()),directions.button=document.getElementById("directions").addEventListener("click",()=>directions.modal.show()),details.button=document.getElementById("details").addEventListener("click",()=>details.modal.show());var t=[];t.push(modalFill(about.modal,"aboutContent.html.txt")),t.push(modalFill(directions.modal,"directionsContent.html.txt")),t.push(modalFill(details.modal,"detailsContent.html.txt"));const e=details.modal,l=directions.modal;Promise.all(t).then(function(){MathJax.Hub.Configured()}).catch(()=>{console.log("MathJax Not Yet Loaded ...");let t=1e3;setTimeout(function o(){try{MathJax.Hub.Configured()}catch(a){console.error(a),t<1e4?(t*=1.5,setTimeout(o,t)):(modalFill(e,"errorText.html.txt"),modalFill(l,"errorText.html.txt"))}},t)})}function addBarChart(){bc=document.createElement("div"),bc.id="barchart",document.body.appendChild(bc),bc=document.getElementById("barchart"),bc.style.display="block",bc.style.position="absolute",bc.style.background="rgba(255, 255, 255, 1)",leftBarBottom=document.createElement("div"),leftBarBottom.id="lbb",leftBarTop=document.createElement("div"),leftBarTop.id="lbt",rightBarBottom=document.createElement("div"),rightBarBottom.id="rbb",rightBarTop=document.createElement("div"),rightBarTop.id="rbt",leftBarLabel=document.createElement("div"),rightBarLabel=document.createElement("div"),leftBarLabel.id="lbl",rightBarLabel.id="rbl",bc.appendChild(leftBarBottom),bc.appendChild(leftBarTop),bc.appendChild(rightBarBottom),bc.appendChild(rightBarTop),bc.appendChild(leftBarLabel),bc.appendChild(rightBarLabel),leftBarBottom=document.getElementById("lbb"),leftBarTop=document.getElementById("lbt"),rightBarBottom=document.getElementById("rbb"),rightBarTop=document.getElementById("rbt"),leftBarLabel=document.getElementById("lbl"),rightBarLabel=document.getElementById("rbl"),leftBarBottom.style.background=`${Acolor}`,rightBarBottom.style.background=`${Acolor}`,leftBarTop.style.background=`${Bcolor}`,rightBarTop.style.background=`${Bcolor}`,leftBarBottom.style.position="absolute",leftBarTop.style.position="absolute",rightBarBottom.style.position="absolute",rightBarTop.style.position="absolute",leftBarLabel.style.position="absolute",rightBarLabel.style.position="absolute",leftBarLabel.innerText="liquid",leftBarLabel.classList.add("label"),rightBarLabel.innerText="vapor",rightBarLabel.classList.add("label"),leftBarLabel.style.textAlign="center",rightBarLabel.style.textAlign="center";let t=1;leftBarTop.style.transition=`height ${t}s`,rightBarTop.style.transition=`height ${t}s`}function drawBarChart(){leftBarTop.style.height=`${barHeight*(1-xAtarget)}px`,rightBarTop.style.height=`${barHeight*(1-yAtarget)}px`}function resize(){const t=window.innerHeight,e=window.innerWidth;nav.style.height=`${buttonHeight}px`,dims=Math.min(Math.max(400,Math.min(e,t-20)),800),rowColumn?dims*=.6:dims-=100,evapFraction=(1-fracLiq)*(dims-liquidLine)/dims/((1-fracLiq)*(dims-liquidLine)/dims+fracLiq*liquidLine/dims),condFraction=fracLiq*liquidLine/dims/((1-fracLiq)*(dims-liquidLine)/dims+fracLiq*liquidLine/dims);const l=40,o=20;if(rowColumn){sliderWidth=1.5*dims/3-40,molNumberSlider.style.width=`${sliderWidth}px`,volatilitySlider.style.width=`${sliderWidth}px`,xSlider.style.width=`${sliderWidth}px`,molNumberLabel.position(10,getCoords("nav").bottom),molNumberSlider.position(0,getCoords("mnl").bottom+10),alphaLabel.position(Math.max(getCoords("mnl").right,getCoords("mns").right)+l,getCoords("mnl").top),volatilitySlider.position(Math.max(getCoords("mnl").right,getCoords("mns").right)+l,getCoords("al").bottom+10);let t=e<Math.max(getCoords("al").right,getCoords("vs").right)+200?getCoords("mnl").left:Math.max(getCoords("al").right,getCoords("vs").right)+l,a=e<Math.max(getCoords("al").right,getCoords("vs").right)+200?getCoords("mns").bottom+o:getCoords("al").top;xLabel.position(t,a),xSlider.position(t,getCoords("xl").bottom+7)}else molNumberLabel.position(getCoords("canvas0").right,getCoords("nav").bottom),molNumberSlider.position(getCoords("canvas0").right,getCoords("mnl").bottom+10),alphaLabel.position(getCoords("canvas0").right,getCoords("mns").bottom+30),volatilitySlider.position(getCoords("canvas0").right,getCoords("al").bottom+10),xLabel.position(getCoords("canvas0").right,getCoords("vs").bottom+30),xSlider.position(getCoords("canvas0").right,getCoords("xl").bottom+10);const a=document.getElementById("canvas0"),i=document.getElementById("liqCanvas"),r=document.getElementById("vapCanvas");a.style.width=`${dims}px`,i.style.width=`${dims}px`,r.style.width=`${dims}px`,a.style.height=`${Math.min(Math.max(dims,t-getCoords("xs").bottom-30),600)}px`,i.style.height=`${getCoords("canvas0").height*liquidLevel}px`,r.style.height=`${getCoords("canvas0").height-getCoords("liqCanvas").height-4}px`;const d=rowColumn?getCoords("xs").bottom+20:getCoords("nav").bottom+20;let n,s,m;a.style.top=`${d}px`,r.style.top="0px",i.style.bottom="0px",liquidLine=(1-liquidLevel)*getCoords("canvas0").height,yDims=getCoords("canvas0").height;const b=getCoords("canvas0").height,p=10;barHeight=b-2*p-Math.max(getCoords("lbl").height,getCoords("rbl").height),rowColumn?(n=dims/2,s=dims+10,m=getCoords("canvas0").top):(n=dims,s=0,m=getCoords("canvas0").bottom+20),leftBarBottom.style.width=`${n/2-2*p}px`,rightBarBottom.style.width=`${n/2-2*p}px`,leftBarTop.style.width=`${n/2-2*p}px`,rightBarTop.style.width=`${n/2-2*p}px`,leftBarLabel.style.width=`${getCoords("lbb").width}px`,rightBarLabel.style.width=`${getCoords("rbb").width}px`,leftBarBottom.style.height=`${barHeight}px`,rightBarBottom.style.height=`${barHeight}px`,leftBarBottom.style.top=`${(b-barHeight)/3}px`,leftBarTop.style.top=`${(b-barHeight)/3}px`,rightBarBottom.style.top=`${(b-barHeight)/3}px`,rightBarTop.style.top=`${(b-barHeight)/3}px`,leftBarBottom.style.left=`${p}px`,leftBarTop.style.left=`${p}px`,rightBarBottom.style.left=`${n/2+p}px`,rightBarTop.style.left=`${n/2+p}px`,leftBarLabel.style.left=`${getCoords("lbb").left-getCoords("barchart").left}px`,rightBarLabel.style.left=`${getCoords("rbb").left-getCoords("barchart").left}px`,bc.style.left=`${s}px`,bc.style.top=`${m}px`,bc.style.width=`${n}px`,bc.style.height=`${b}px`,leftBarLabel.style.bottom="0px",rightBarLabel.style.bottom="0px",nav.style.width=`${s+n}px`}function getCoords(t){const e=document.getElementById(t),l=e.getBoundingClientRect();return{top:l.top+pageYOffset,left:l.left+pageXOffset,bottom:l.top+pageYOffset+l.height,right:l.left+pageXOffset+l.width,height:l.height,width:l.width}}function addSliders(){sliderWidth=100,molNumberLabel=document.createElement("div"),molNumberLabel.id="mnl",mainDiv.appendChild(molNumberLabel),molNumberLabel=document.getElementById("mnl"),molNumberLabel.innerHTML=`number of particles: ${mols}`,molNumberLabel.classList.add("label"),molNumberLabel.position=((t,e)=>{molNumberLabel.style.left=`${t}px`,molNumberLabel.style.top=`${e}px`}),molNumberSlider=document.createElement("input"),molNumberSlider.id="mns",mainDiv.appendChild(molNumberSlider),molNumberSlider=document.getElementById("mns"),molNumberSlider.type="range",molNumberSlider.classList.add("slider"),molNumberSlider.min=50,molNumberSlider.max=500,molNumberSlider.value=100,molNumberSlider.step=1,molNumberSlider.style.width=`${sliderWidth}px`,molNumberSlider.position=((t,e)=>{molNumberSlider.style.left=`${t}px`,molNumberSlider.style.top=`${e}px`}),alphaLabel=document.createElement("div"),alphaLabel.id="al",mainDiv.appendChild(alphaLabel),alphaLabel=document.getElementById("al"),alphaLabel.innerHTML=`relative volatility (&#945<sub>blue/green</sub>): ${Number.parseFloat(Alpha).toFixed(2)}`,alphaLabel.classList.add("label"),alphaLabel.position=((t,e)=>{alphaLabel.style.left=`${t}px`,alphaLabel.style.top=`${e}px`}),volatilitySlider=document.createElement("input"),volatilitySlider.id="vs",mainDiv.appendChild(volatilitySlider),volatilitySlider=document.getElementById("vs"),volatilitySlider.type="range",volatilitySlider.classList.add("slider"),volatilitySlider.min=-100,volatilitySlider.max=100,volatilitySlider.value=0,volatilitySlider.step=1,volatilitySlider.style.width=`${sliderWidth}px`,volatilitySlider.position=((t,e)=>{volatilitySlider.style.left=`${t}px`,volatilitySlider.style.top=`${e}px`}),xLabel=document.createElement("div"),xLabel.id="xl",mainDiv.appendChild(xLabel),xLabel=document.getElementById("xl"),xLabel.innerHTML=`<i>x</i><sub>blue</sub>: ${Number.parseFloat(xAtarget).toFixed(2)}`,xLabel.classList.add("label"),xLabel.position=((t,e)=>{xLabel.style.left=`${t}px`,xLabel.style.top=`${e}px`}),xSlider=document.createElement("input"),xSlider.id="xs",mainDiv.appendChild(xSlider),xSlider=document.getElementById("xs"),xSlider.type="range",xSlider.classList.add("slider"),xSlider.min=.03,xSlider.max=.97,xSlider.step=.01,xSlider.value=.5,xSlider.style.width=`${sliderWidth}px`,xSlider.position=((t,e)=>{xSlider.style.left=`${t}px`,xSlider.style.top=`${e}px`}),molNumberLabel.style.position="absolute",molNumberSlider.style.position="absolute",alphaLabel.style.position="absolute",volatilitySlider.style.position="absolute",xLabel.style.position="absolute",xSlider.style.position="absolute",document.getElementById("mns").oninput=updateGlobals,document.getElementById("vs").oninput=updateGlobals,document.getElementById("xs").oninput=updateGlobals}let sliderWidth,nav,buttonHeight,about,details,directions,dims,cnv,bc,barHeight,xLabel,xSlider,leftBarLabel,rightBarLabel,leftBarTop,leftBarBottom,rightBarTop,rightBarBottom,mainDiv,liquidColor,liquidLine,alphaLabel,molNumberSlider,molNumberLabel,evapFraction,condFraction,mol=[],liquidLevel=.15;var mols=100,Alpha=1,fracLiq=.85,molsVapor=[0,0,0],molsLiquid=[0,0,0],xA=.5,xB=.5,yA=.5,yB=.5,zA=.5,xAtarget=.5,yAtarget=.5;let Acolor="rgb(80, 0, 180)",Bcolor="rgb(130, 180, 0)",rowColumn=!0;var fps,fpsInterval,startTime,now,then,elapsed,yDims,timeNow=null,stop=!1,frameCount=0,onoff=!0;window.onload=(t=>{mainDiv=document.getElementById("main"),addButtons(),addSliders(),addBarChart(),resize();for(let t=0;t<mols;t++)t%2==0?mol.push(new Molecule({component:"a"})):mol.push(new Molecule({component:"b"}));updateGlobals(),startAnimating(120)});