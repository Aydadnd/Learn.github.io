var setup,draw,drawPage,next,reset,resizeFont,windowResized,selectItem,getCoords,applyEffect,glow,glowList;let instrX,fps,w,h,update,page,effects,effect,choices,domObjs,instrY,eqns,texX,texY,lnHt,letters,glowLetters,partials,constant,rhs,finalEq,largeFontSize,topPartial,bottomPartial,constantText,refLeft,constantIndex,i,fontSize,running,prg,x1,y1,x2,y2;(function(){var e=this,t=function(){let e=document.getElementById("main"),t=document.createElement("button");t.id="resetbutton",t.innerText="reset",t.onclick=reset,t.style.zIndex=2,t.style.position="absolute",t.style.top="10px",e.appendChild(t);let n=windowResized(!0);t.style.left=`${instrX}px`;let i=createCanvas(n,n);i.parent("main"),i.position(0,0),i.style("z-index",0),frameRate(fps),w=n/100,h=n/100,textAlign(LEFT,TOP),windowResized(),background(255,255,255)},n=function(){update&&drawPage(page),effects&&applyEffect(effect),update=!1},o=function(e){switch(clear(),e){case 1:removeElements(),choices=[],domObjs=[],effect=[],text("Click an equation to get started.",instrX,instrY);let t=Object.keys(eqns.fundamentals);for(let e=0;e<t.length;e++){domObjs.push(new Tex({content:eqns.fundamentals[t[e]],position:[texX,texY+lnHt*(e+1)],name:`${t[e]}`})),domObjs[e].div.addClass("eq"),domObjs[e].div.id(`eq${e}`);let n=`${e}`;document.getElementById(`eq${n}`).addEventListener("mousedown",()=>{1==page&&choices.push(parseInt(n)),next(1,choices[0])})}break;case 2:text("Click the differential term you would like held constant\n(options are colored)",instrX,instrY);for(let e=0;e<domObjs.length;e++)e!=choices[0]&&domObjs[e].div.remove();effect=[],letters=document.querySelectorAll("mjx-container")[0].firstChild.childNodes,glowLetters=0==choices[0]||2==choices[0]?[0,1,4,5,8,9]:1==choices[0]||3==choices[0]?[0,1,5,6,9,10]:[0,1,4,5,8,9];for(let e=0;e<glowLetters.length;e++){let t=letters[glowLetters[e]],n=`${Math.floor(e/2)}`;effect.push({target:t,effect:"color",color:`${n}`}),e>=2&&t.addEventListener("mousedown",()=>{next(2,n)})}effects=!0;break;case 3:domObjs.push(new Tex({content:`\\left( \\frac{\\partial ${partials[0]}}{\\partial ${partials[1]}} \\right)_{\\scriptscriptstyle ${constant}}=${rhs}`,position:[texX,texY],name:"partial"})),domObjs[domObjs.length-1].div.id("final"),finalEq=document.querySelectorAll("mjx-container")[1].firstChild,finalEq.style.fontSize=`${largeFontSize}rem`,topPartial=finalEq.firstChild.childNodes[0].childNodes[1].firstChild.childNodes[0],bottomPartial=finalEq.firstChild.childNodes[0].childNodes[1].firstChild.childNodes[1],constantText=finalEq.firstChild.childNodes[1],refLeft=getCoords(constantText).right,domObjs[domObjs.length-1].div.hide(),effect.push({target:[letters[constantIndex],letters[constantIndex+1]],effect:"zeroAndDelete"}),effects=!0,loop();break;case 4:text("With constant",instrX,instrY);let n=domObjs[domObjs.length-1];n.div.show(),n.div.style("opacity","0"),effect.push({target:topPartial,effect:"color",color:0}),effect.push({target:bottomPartial,effect:"color",color:`${1==choices[1]?2:1}`}),effect.push({target:constantText,effect:"color",color:`${2==choices[1]?2:1}`}),effects=!0,next(4,null);break;case 5:text("With constant ",instrX,instrY);let i=textWidth("With constant "),o=new Tex({content:`${constant},`,position:[instrX+i+.05*lnHt,instrY-.1*lnHt]});o.div.id("constantLetter"),effect.push({target:document.getElementById("constantLetter"),effect:"color",color:`${2==choices[1]?2:1}`}),effects=!0,page++,window.setTimeout(e=>{update=!0},2e3);break;case 6:text("With constant",instrX,instrY),text("therefore,",instrX,texY+2.5*lnHt),window.setTimeout(e=>{update=!0},2e3),page++;break;case 7:text("With constant",instrX,instrY),text("therefore,",instrX,texY+2.5*lnHt);let s=document.getElementById("final");s.style.top=`${texY+4*lnHt}px`,s.style.opacity=1,noLoop()}update=!1},s=function(e,t){if(e==page)switch(page){case 1:let e;for(i=0;i<domObjs.length;i++){e=i!=t?"fade":"expand";let n=document.getElementById(`eq${i}`);effect.push({target:n,effect:e})}effects=!0,redraw(),update=!0,page++;break;case 2:choices.push(t);let n=Object.keys(eqns.fundamentals),o=eqns.fundamentals[n[choices[0]]];constant=o.charAt(glowLetters[2*t+1]),constantIndex=glowLetters[2*t],glowLetters.splice(2*t,2);let s=o.charAt(glowLetters[2]-1);for(rhs="-"==o.charAt(glowLetters[2]-2)?`-${s}`:`${s}`,partials=[],i=0;i<glowLetters.length/2;i++)partials.push(o[glowLetters[2*i+1]]);update=!0,page++;break;case 3:effect=[],effects=!1,page++,drawPage(page);break;case 4:page++,drawPage(page)}},r=function(){location.reload()},l=function(){let e=Number(window.getComputedStyle(document.getElementById("main")).getPropertyValue("font-size").replace(/[^\d.-]/g,""));fontSize=100*w<400?e:100*w<1200?100*w/28:1200/28,textSize(fontSize),lnHt=1.5*fontSize,instrX=5*w,instrY=lnHt+10+getCoords(document.getElementById("resetbutton")).height,texX=instrX,texY=instrY+lnHt,largeFontSize=2.2*fontSize/10},a=function(e){let t=windowWidth,n=windowHeight,i=Math.min(t,n);if(w=i/100,h=i/100,resizeFont(),1==e)return i;resizeCanvas(i,i),update=!0},c=function(e,t,n,i){let o=[],s=[];o=0==n?[0,2]:-1!=e.search("=-")?1==n?[3,7]:2==n?[7,11]:3==n?[11,15]:[0,2]:1==n?[3,6]:2==n?[6,10]:3==n?[10,14]:[0,2];for(let e=o[0];e<o[1];e++)s.push(t[e]);return i?e.slice(o[0],o[1]):s},d=function(e){let t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset,bottom:t.top+pageYOffset+t.height,right:t.left+pageXOffset+t.width,height:t.height,width:t.width}},f=function(e){e.delete;let t=e.time||.5;for(i=0;i<e.length;i++){let o=e[i].target,s=e[i].effect,r=e[i].color||null,l="cnvElement"!=(e[i].type||"DOM");if(l)switch(s){case"fade":o.style.opacity=1,o.style.transition=`opacity ${t}s`,o.style.opacity=0;break;case"expand":o.style.fontSize=fontSize,o.style.transition="all 1s",o.firstChild.style.transition="all 1s",o.firstChild.style.fontSize=`${largeFontSize}rem`,o.style.top=`${texY+1.2*lnHt}px`;break;case"glow":glow({continuous:2==page,duration:2e3,element:o,id:Math.floor(i/2)});break;case"color":glow({continuous:!1,duration:1e3,element:o,id:r});break;case"zeroAndDelete":let e=[0,.5,1,1.5,2,2.5,3];var n=[.04,.04,.04,.025,.025,.025];if(running){if(running&&prg<e[1]){prg+=n[0];let t=e[1]-e[0];push(),strokeWeight(4),line(x1,y1,(1-prg/t)*x1+prg/t*x2,(1-prg/t)*y1+prg/t*y2),pop()}else if(running&&prg<e[2]){prg+=n[1];let t=e[2]-e[1];push(),noStroke(),fill(`rgba(0, 0, 0, ${(prg-e[1])/t})`),text("0",x2,y2-lnHt),pop()}else if(running&&prg<e[3])prg+=n[2];else if(running&&prg<e[4]){prg+=n[3];let t=e[4]-e[3],i=Object.keys(eqns.fundamentals),o=eqns.fundamentals[i[choices[0]]];selectItem(o,letters,choices[1]).forEach(function(n){n.style.opacity=(e[4]-prg)/t}),clear(),push(),noStroke(),fill(`rgba(0, 0, 0, ${Math.max((e[4]-prg)/t,0)})`),text("0",x2,y2-lnHt),stroke(`rgba(0, 0, 0, ${Math.max((e[4]-prg)/t,0)})`),strokeWeight(4),line(x1,y1,x2,y2),pop(),(e[4]-prg)/t<.05&&(selectItem(o,letters,choices[1]).forEach(function(e){e.style.visibility="hidden"}),clear())}else if(running&&prg<e[5]){if(prg<e[4]+n[4]){let t=e[5]-e[4],i=document.getElementById(`eq${choices[0]}`);i.style.transition=`all ${t/n[4]/fps}s`,i.style.top=`${texY}px`;let o=refLeft-getCoords(letters[2]).left,s=getCoords(letters[0]).left;i.style.left=`${s+o}px`}prg+=n[4]}else if(running&&prg<e[6]){prg+=n[5];let t=e[6]-e[5];if(1==choices[1]){let e=Object.keys(eqns.fundamentals),i=eqns.fundamentals[e[choices[0]]],o=getCoords(selectItem(i,letters,1)[0]).left,s="+"!=selectItem(i,letters,2,!0).charAt(0),r=selectItem(i,letters,2);s||(r[0].style.visibility="hidden",r.shift());let l=getCoords(r[0]).left;r.forEach(function(e){e.style.transition=`all ${t/n[5]/fps}s`,e.style.transform=`translateX(${o-l}px)`})}prg=e[6]}else if(running&&prg>=e[6])return running=!1,prg=0,next(3,null)}else{for(prg=0,x1=getCoords(o[0]).left,x2=getCoords(o[1]).right,y1=getCoords(o[0]).bottom+10+.5*lnHt,y2=getCoords(o[1]).top+10-.5*lnHt,running=!0,effects=!0,update=!1,i=0;i<domObjs.length;i++)domObjs[i].div.style("z-index","-1");loop()}}}},p=function({continuous:e,duration:t,element:n,id:i}){let o=Math.floor(t*fps/1e3),s=frameCount%o/o,r=e?.5+.5*Math.sin(s*Math.PI):1,l=0==i?[0,0,0]:1==i?[70,200,50]:2==i?[100,100,255]:[0,0,0],a=`rgb(${l[0]*r},${l[1]*r},${l[2]*r})`;n.style.color=a,e&&loop()};e.setup=t,e.draw=n,e.drawPage=o,e.next=s,e.reset=r,e.resizeFont=l,e.windowResized=a,e.selectItem=c,e.getCoords=d,e.applyEffect=f,e.glow=p;var g=class{constructor(e){this.name=e.name||String("tex",Math.floor(1e6*Math.random())),this.content=e.content||"hey put some text here",this.position=e.position||[0,0],this.div=createDiv(`\\( ${this.content}\\)`),this.div.parent("main"),this.div.style("font-size",`${fontSize/10}rem`),this.div.position(this.position[0],this.position[1]),MathJax.typeset()}};e.Tex=g,e.glowList=[],instrX=void 0,fps=20,w=void 0,h=void 0,update=!1,page=1,effects=!1,effect=[],choices=[],domObjs=[],instrY=void 0,eqns={fundamentals:{U:"dU=TdS-PdV",A:"dA=-SdT-PdV",H:"dH=TdS+VdP",G:"dG=-SdT+VdP",Rand:"d§=▲d♫-♣dΩ"}},texX=void 0,texY=void 0,lnHt=void 0,letters=[],glowLetters=[],partials=[],constant=void 0,rhs=void 0,finalEq=void 0,largeFontSize=void 0,topPartial=void 0,bottomPartial=void 0,constantText=void 0,refLeft=void 0,constantIndex=void 0,i=void 0,fontSize=void 0,running=!1,prg=0,x1=void 0,y1=void 0,x2=void 0,y2=void 0}).call(this);